%Structured Grids for the "2D projection of a flying carpet" %By Pedro Lopez, a good friend of 2.29 % nxsi = 31; neta=nxsi+10; xsi1 = 0; xsi2 = 1; eta1 = 0; eta2 = 1; xsi = linspace(xsi1, xsi2, nxsi); eta = linspace(eta1, eta2, neta); XSI=repmat(xsi,neta,1); ETA=repmat(eta',1,nxsi); f_s=[xsi; -sin(2*pi*xsi)/4]; f_n=[1+xsi; 3-sin(-2*pi*xsi)/4+2*xsi]; f_e=[(1+eta); (1+eta).^3-2*(1+eta)+1]; f_w=[eta; 3*sqrt(eta)]; f_s=[xsi; -sin(2*pi*xsi)/4]; f_n=[1+xsi; 3-sin(2*pi*xsi)/4]; f_e=[(1+eta); ((1+eta).^2-(1+eta))*3/2]; f_w=[eta; 3*sqrt(eta)]; % F(0,0) F(1,0) F(0,1) F(1,1) fsw=f_s(:,1);fse=f_s(:,nxsi);fnw=f_n(:,1);fne=f_n(:,nxsi); figure plot(f_s(1,:),f_s(2,:),'-*') hold on;grid on; plot(f_n(1,:),f_n(2,:),'-r*') plot(f_e(1,:),f_e(2,:),'-c*') plot(f_w(1,:),f_w(2,:),'-g*') Ux=f_w(1,:)'*(1-xsi) + f_e(1,:)'*xsi + (1-eta)'*f_s(1,:) + eta'*f_n(1,:) - ... [(1-eta)'*(1-xsi)*fsw(1) + eta'*(1-xsi)*fnw(1) + (1-eta)'*xsi*fse(1) + eta'*xsi*fne(1)]; Uy=f_w(2,:)'*(1-xsi) + f_e(2,:)'*xsi + (1-eta)'*f_s(2,:) + eta'*f_n(2,:) - ... [(1-eta)'*(1-xsi)*fsw(2) + eta'*(1-xsi)*fnw(2) + (1-eta)'*xsi*fse(2) + eta'*xsi*fne(2)]; figure plot(Ux,Uy,'b',Ux',Uy','b') hold on;grid on;